/*! Lity - v3.0.0-dev - 2018-07-09
* http://sorgalla.com/lity/
* Copyright (c) 2015-2018 Jan Sorgalla; Licensed MIT */
!function(e,t){"function"==typeof define&&define.amd?define(["jquery"],(function(n){return t(e,n)})):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,require("jquery")):e.lity=t(e,e.jQuery||e.Zepto)}("undefined"!=typeof window?window:this,(function(e,t){"use strict";var n=e.document,i=t(e),r=t.Deferred,a=t("html"),o=[],l={esc:!0,handler:null,handlers:{image:h,inline:function(e,n){var i,r,a;try{i=t(e)}catch(e){return!1}if(!i.length)return!1;return r=t('<i style="display:none !important"/>'),a=i.hasClass("lity-hide"),n.element().one("lity:remove",(function(){r.before(i).remove(),a&&!i.closest(".lity-content").length&&i.addClass("lity-hide")})),i.removeClass("lity-hide").after(r)},iframe:function(e,t){return y(e,t)}},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'},d=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i,s=function(){var e=n.createElement("div"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return t[i];return!1}();function c(e){var t=r();return s&&e.length?(e.one(s,t.resolve),setTimeout(t.resolve,500)):t.resolve(),t.promise()}function u(e,n,i){if(1===arguments.length)return t.extend({},e);if("string"==typeof n){if(void 0===i)return void 0===e[n]?null:e[n];e[n]=i}else t.extend(e,n);return this}function f(e){var t=e.indexOf("?");t>-1&&(e=e.substr(t+1));for(var n,i=decodeURI(e.split("#")[0]).split("&"),r={},a=0,o=i.length;a<o;a++)i[a]&&(r[(n=i[a].split("="))[0]]=n[1]);return r}function y(e,n,i,r){var a,o,l;return n&&n.element().addClass("lity-iframe"),i&&(e=function(e,n){if(!n)return e;if("string"===t.type(n)&&(n=f(n)),e.indexOf("?")>-1){var i=e.split("?");e=i.shift(),n=t.extend({},f(i[0]),n)}return e+"?"+t.param(n)}(e,i)),r&&(o=e,e=-1===(l=(a=r).indexOf("#"))?o:(l>0&&(a=a.substr(l)),o+a)),'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+e+'"/></div>'}function h(e,n){var i=n.opener()&&n.opener().data("lity-desc")||"Image with no description",a=t('<img src="'+e+'" alt="'+i+'"/>'),o=r(),l=function(){var e;o.reject((e="Failed loading image",t('<span class="lity-error"/>').append(e)))};return a.on("load",(function(){if(0===this.naturalWidth)return l();o.resolve(a)})).on("error",l),o.promise()}function v(){return n.documentElement.clientHeight?n.documentElement.clientHeight:Math.round(i.height())}function m(e){var t=g();t&&(27===e.keyCode&&t.options("esc")&&t.close(),9===e.keyCode&&function(e,t){var i=t.element().find('a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])'),r=i.index(n.activeElement);e.shiftKey&&r<=0?(i.get(i.length-1).focus(),e.preventDefault()):e.shiftKey||r!==i.length-1||(i.get(0).focus(),e.preventDefault())}(e,t))}function p(){t.each(o,(function(e,t){t.resize()}))}function g(){return 0===o.length?null:o[0]}function b(e,d,s,f){var y,h,g,b,x=this,w=!1,C=!1;d=t.extend({},l,d),h=t(d.template),x.element=function(){return h},x.opener=function(){return s},x.content=function(){return g},x.options=t.proxy(u,x,d),x.handlers=t.proxy(u,x,d.handlers),x.resize=function(){w&&!C&&g.css("max-height",v()+"px").trigger("lity:resize",[x])},x.close=function(){if(w&&!C){var e;C=!0,(e=x).element().attr("aria-hidden","true"),1===o.length&&(a.removeClass("lity-active"),i.off({resize:p,keydown:m})),((o=t.grep(o,(function(t){return e!==t}))).length?o[0].element():t(".lity-hidden")).removeClass("lity-hidden").each((function(){var e=t(this),n=e.data("lity-aria-hidden");n?e.attr("aria-hidden",n):e.removeAttr("aria-hidden"),e.removeData("lity-aria-hidden")}));var l=r();if(f&&(n.activeElement===h[0]||t.contains(h[0],n.activeElement)))try{f.focus()}catch(e){}return g.trigger("lity:close",[x]),h.removeClass("lity-opened").addClass("lity-closed"),c(g.add(h)).always((function(){g.trigger("lity:remove",[x]),h.remove(),h=void 0,l.resolve()})),l.promise()}},y=function(e,n,i,r){var a,o="inline",l=t.extend({},i);return r&&l[r]?(a=l[r](e,n),o=r):(t.each(["inline","iframe"],(function(e,t){delete l[t],l[t]=i[t]})),t.each(l,(function(t,i){return!i||(!(!i.test||i.test(e,n))||(!1!==(a=i(e,n))?(o=t,!1):void 0))}))),{handler:o,content:a||""}}(e,x,d.handlers,d.handler),h.attr("aria-hidden","false").addClass("lity-loading lity-opened lity-"+y.handler).appendTo("body").focus().on("click","[data-lity-close]",(function(e){t(e.target).is("[data-lity-close]")&&x.close()})).trigger("lity:open",[x]),b=x,1===o.unshift(b)&&(a.addClass("lity-active"),i.on({resize:p,keydown:m})),t("body > *").not(b.element()).addClass("lity-hidden").each((function(){var e=t(this);void 0===e.data("lity-aria-hidden")&&e.data("lity-aria-hidden",e.attr("aria-hidden")||null)})).attr("aria-hidden","true"),t.when(y.content).always((function(e){g=t(e).css("max-height",v()+"px"),h.find(".lity-loader").each((function(){var e=t(this);c(e).always((function(){e.remove()}))})),h.removeClass("lity-loading").find(".lity-content").empty().append(g),w=!0,g.trigger("lity:ready",[x])}))}function x(e,i,r){e.preventDefault?(e.preventDefault(),e=(r=t(this)).data("lity-target")||r.attr("href")||r.attr("src")):r=t(r);var a=new b(e,t.extend({},r.data("lity-options")||r.data("lity"),i),r,n.activeElement);if(!e.preventDefault)return a}return h.test=function(e){return d.test(e)},x.version="3.0.0-dev",x.options=t.proxy(u,x,l),x.handlers=t.proxy(u,x,l.handlers),x.current=g,x.iframe=y,t(n).on("click.lity","[data-lity]",x),x}));